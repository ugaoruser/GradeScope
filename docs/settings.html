<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GradeTracker â€” Settings</title>
  <link rel="icon" href="../favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="styles.css">
  <script src="config.js" defer></script>
</head>
<body class="settings-page">
  <div class="sidebar">
    <div class="top">
      <ul class="nav">
        <li id="goHome">Home</li>
        <li class="active">Settings</li>
        <li id="aboutBtn">About</li>
      </ul>
    </div>
    <div class="bottom">
      <div class="app-version">Grade Tracker v1.0</div>
    </div>
  </div>
  
  <div class="main">
    <header class="header" style="margin-bottom:16px;">
      <div class="header-title">Settings</div>
      <div class="account-menu">
        <button class="account-btn" id="accountBtn"><span id="accountInitial">A</span></button>
        <div class="account-dropdown" id="accountDropdown" aria-hidden="true">
          <div class="account-info">
            <div id="userFullName">User Name</div>
            <div id="userEmail"></div>
          </div>
          <button id="logoutBtn" class="logout-btn">Log Out</button>
        </div>
      </div>
    </header>
    
    <div class="settings-container">
      <div class="settings-title">Account Settings</div>
      
      <div class="settings-grid">
        <div class="settings-card">
          <div class="settings-section-title">Profile Information</div>
          <ul style="list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:8px;">
            <li><strong>First Name:</strong> <span id="displayFirstName" class="field-display" style="display:inline-block; margin-left:8px; border:none; background:transparent; padding:0;"></span></li>
            <li><strong>Last Name:</strong> <span id="displayLastName" class="field-display" style="display:inline-block; margin-left:8px; border:none; background:transparent; padding:0;"></span></li>
            <li><strong>Email:</strong> <span id="displayEmail" class="field-display" style="display:inline-block; margin-left:8px; border:none; background:transparent; padding:0;"></span></li>
          </ul>
        </div>

        <div class="settings-card danger">
          <div class="settings-section-title">Danger Zone</div>
          <p>Once you delete your account, there is no going back. Please be certain.</p>
          <button class="btn btn-danger" id="deleteAccountBtn">Delete Account</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- About Modal (no profile info) -->
<div id="aboutModal" class="modal" role="dialog" aria-modal="true" aria-hidden="true" tabindex="-1" style="display:none;">
    <div class="modal-panel">
      <div class="modal-header">
        <div class="modal-title">About GradeTracker</div>
        <button class="modal-close" onclick="closeAbout()" aria-label="Close">&times;</button>
      </div>
      <div class="modal-body">
        <p>This website acts as a Grade Tracker to track the quizzes and scores of students in a more faster way. It can be used by students, teachers, and parents.</p>
        <p><strong>Version:</strong> V1.0</p>
        <p><strong>Developed by:</strong> Group 4 Practical Research Group [12-Lovelace]</p>
        <p><strong>Main Dev:</strong> Jack Dylan Gallentes</p>
      </div>
    </div>
  </div>
  
  
  <script>
    // Auth
    const token = localStorage.getItem('token');
    if (!token) { window.location.href = 'login.html'; }

    // Load profile
    fetch(`${window.API_BASE}/api/me`, { headers: { Authorization: 'Bearer ' + token }})
      .then(r => r.json())
      .then(u => {
        document.getElementById('displayFirstName').textContent = u.firstName || '';
        document.getElementById('displayLastName').textContent = u.lastName || '';
        document.getElementById('displayEmail').textContent = u.email || localStorage.getItem('email') || '';
      });

    // About modal
    const aboutBtn = document.getElementById('aboutBtn');
    const aboutModal = document.getElementById('aboutModal');
    function showAbout(){ aboutModal.style.display = 'flex'; requestAnimationFrame(()=> aboutModal.classList.add('show')); }
    function closeAbout(){ aboutModal.classList.remove('show'); setTimeout(()=> aboutModal.style.display='none', 180); }
    aboutBtn.addEventListener('click', showAbout);

    // Danger zone
    document.getElementById('deleteAccountBtn').addEventListener('click', () => {
      alert('Account deletion is not enabled in this demo.');
    });
    // Removed undefined element handlers
    
    // Profile editing disabled - display only
    
    // Password change disabled
    
    // Account deletion handled above with demo message
    
    // Close modals when clicking outside
    window.addEventListener('click', (event) => {
      if (event.target === aboutModal) {
        closeAbout();
      }
    });
    window.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeAbout(); });
    // Dynamic home routing based on role
    document.getElementById('goHome').addEventListener('click', ()=>{
      const r = localStorage.getItem('role');
      location.href = r === 'teacher' ? 'homepage2.html' : 'homepage1.html';
    });
  </script>
</body>
</html>
